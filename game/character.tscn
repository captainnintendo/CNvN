[gd_scene load_steps=12 format=2]

[ext_resource path="res://assets/maujoe.camera_control/scripts/camera_control.gd" type="Script" id=1]

[sub_resource type="CubeMesh" id=1]

[sub_resource type="SpatialMaterial" id=2]
albedo_color = Color( 0, 0.337255, 0.054902, 1 )

[sub_resource type="BoxShape" id=3]

[sub_resource type="GDScript" id=4]
script/source = "extends KinematicBody

var gravity = Vector3.DOWN * 12  # strength of gravity

var speed = 5  # movement speed

var jump_speed = 10  # jump strength

var spin = 0.1  # rotation speed


var velocity = Vector3()
var jump = false

func get_input():
	var vy = velocity.y
	velocity = Vector3()
	if Input.is_action_pressed(\"move_forward\"):
		velocity += -transform.basis.z * speed
	if Input.is_action_pressed(\"move_back\"):
		velocity += transform.basis.z * speed
	if Input.is_action_pressed(\"strafe_right\"):
		velocity += transform.basis.x * speed
	if Input.is_action_pressed(\"strafe_left\"):
		velocity += -transform.basis.x * speed
	velocity.y = vy
	jump = false
	if Input.is_action_just_pressed(\"jump\"):
		jump = true

func _physics_process(delta):
	velocity += gravity * delta
	get_input()
	velocity = move_and_slide(velocity, Vector3.UP)
	if jump and is_on_floor():
		velocity.y = jump_speed

func _unhandled_input(event):
	if event is InputEventMouseMotion:
		if event.relative.x > 0:
			rotate_y(-lerp(0, spin, event.relative.x/10))
		elif event.relative.x < 0:
			rotate_y(-lerp(0, spin, event.relative.x/10)
)
"

[sub_resource type="SphereMesh" id=5]

[sub_resource type="Skin" id=6]

[sub_resource type="SphereShape" id=7]

[sub_resource type="CubeMesh" id=8]

[sub_resource type="Skin" id=9]

[sub_resource type="BoxShape" id=10]

[node name="Spatial" type="Spatial"]

[node name="MeshInstance" type="MeshInstance" parent="."]
transform = Transform( 25, 0, 0, 0, 1, 0, 0, 0, 25, 0, -0.042284, 0 )
mesh = SubResource( 1 )
material/0 = SubResource( 2 )

[node name="StaticBody" type="StaticBody" parent="MeshInstance"]

[node name="CollisionShape" type="CollisionShape" parent="MeshInstance/StaticBody"]
shape = SubResource( 3 )

[node name="KinematicBody" type="KinematicBody" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.830485, 0 )
script = SubResource( 4 )

[node name="Camera" type="Camera" parent="KinematicBody"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 4, 7 )
keep_aspect = 0
doppler_tracking = 1
script = ExtResource( 1 )
mouse_mode = 1

[node name="MeshInstance" type="MeshInstance" parent="KinematicBody"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0 )
mesh = SubResource( 5 )
skin = SubResource( 6 )
material/0 = null

[node name="CollisionShape" type="CollisionShape" parent="KinematicBody"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.09414, 0 )
shape = SubResource( 7 )

[node name="SpotLight" type="SpotLight" parent="."]
transform = Transform( 1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 73.534, 0 )
spot_range = 153.227

[node name="MeshInstance2" type="MeshInstance" parent="."]
transform = Transform( 2, 0, 0, 0, 2, 0, 0, 0, 2, 0, 3.35381, -4.8798 )
mesh = SubResource( 8 )
skin = SubResource( 9 )
material/0 = null

[node name="RigidBody" type="RigidBody" parent="MeshInstance2"]
mode = 1
mass = 0.00102041
can_sleep = false

[node name="CollisionShape" type="CollisionShape" parent="MeshInstance2/RigidBody"]
shape = SubResource( 10 )
